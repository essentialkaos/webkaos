diff -urN lua-nginx-module-0.10.21-orig/src/ngx_http_lua_headers_in.c lua-nginx-module-0.10.21/src/ngx_http_lua_headers_in.c
--- lua-nginx-module-0.10.21-orig/src/ngx_http_lua_headers_in.c	2022-03-02 09:54:22.000000000 +0300
+++ lua-nginx-module-0.10.21/src/ngx_http_lua_headers_in.c	2022-07-04 14:32:05.000000000 +0300
@@ -152,9 +152,15 @@
                  ngx_http_set_builtin_header },
 #endif
 
+#if defined(nginx_version) && nginx_version >= 1023000
+    { ngx_string("Cookie"),
+                 offsetof(ngx_http_headers_in_t, cookie),
+                 ngx_http_set_builtin_multi_header },
+#else
     { ngx_string("Cookie"),
                  offsetof(ngx_http_headers_in_t, cookies),
                  ngx_http_set_builtin_multi_header },
+#endif
 
     { ngx_null_string, 0, ngx_http_set_header }
 };
